---
// src/components/CatalogoGrid.astro

import raw from '../lib/cursos.json';
const courses = Array.isArray(raw.data) ? raw.data : [];
---

<section id="catalogo" class="container mx-auto py-8">
  <!-- Control de filtrado por proveedor -->
  <div class="flex items-center mb-6 gap-4">
    <label for="provider-filter" class="font-medium">Proveedor:</label>
    <input
      id="provider-filter"
      type="text"
      placeholder="Ej: GEORGALOS HNOS SAICA"
      class="border rounded p-1 w-48"
    />
    <button
      id="filter-btn"
      class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition"
    >
      Filtrar
    </button>
  </div>

  <!-- Grid de productos -->
  <div id="grid" class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
    {courses.map(course => (
      <div
        class="card bg-white p-4 rounded-lg shadow-md"
        data-provider={course.proveedorNombre.toLowerCase()}
      >
        <h2 class="text-xl font-bold mb-2">{course.idArticulo}</h2>
        <p class="text-gray-700 mb-2">{course.descripcion}</p>
        <p class="text-gray-500">Proveedor: {course.proveedorNombre}</p>
        <p class="text-gray-500">Precio: {course.precioLista4}</p>
      </div>
    ))}
  </div>
</section>

<script type="module">
  const btn = document.getElementById('filter-btn');
  const input = document.getElementById('provider-filter');
  const grid = document.getElementById('grid');

  btn.addEventListener('click', () => {
    const filterText = input.value.trim().toLowerCase();

    grid.querySelectorAll('[data-provider]').forEach(card => {
      const prov = card.dataset.provider;
      // si el filtro está vacío mostramos todo
      if (filterText === '' || prov.includes(filterText)) {
        card.style.display = '';
      } else {
        card.style.display = 'none';
      }
    });
  });
</script>
